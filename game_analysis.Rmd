---
title: "game_analysis"
author: "Yifan Wang"
date: '2022-04-02'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Prepare for analysis

```{r include=FALSE}
# packages
library(tidyverse)
library(dplyr)
library(ggplot2)
library(viridis)
```

```{r load data}
# load data
games <- read.csv('/Users/yifanwang/Desktop/vgsales.csv')

# we only use observations that have no null values
games1<- games[games$Year != "N/A",]

games1$Rank <- NULL
```

```{r}
# take a quick look of our data
summary(games1)
```

```{r}
# show the first 10 observations
head(games1, 10)
```

# Now we do some data analysis and visualize them

## we will analysis the following topics

### 1. the top 5 game sales in global, North America, Japan, Europe scale

#### the top 5 game sales in global scale

```{r}
#the top 5 game sales in global scale
top5sales.global <- games1 %>% 
  # order data with descending Global_Sales
  arrange(desc(Global_Sales)) %>%
  # only select two column: Name, Global_Sales
  select(Name,Global_Sales) %>% 
  slice_head(n=5) %>%
  print
```
```{r}
ggplot(data=top5sales.global)+
  geom_bar(aes(reorder(Name, Global_Sales), Global_Sales,fill = Global_Sales), stat = 'identity') + 
  scale_fill_viridis_c() +
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1,face="bold")) + labs(
    title = 'top 5 game sales in global scale',
    x = 'Name') 
```

#### the top 5 game sales in North America

```{r}
#the top 5 game sales in NA
top5sales.NA <- games1 %>% 
  # order data with descending Global_Sales
  arrange(desc(NA_Sales)) %>%
  # only select two column: Name, Global_Sales
  select(Name,NA_Sales) %>% 
  slice_head(n=5) %>%
  print
```

```{r}
ggplot(data=top5sales.NA)+
  geom_bar(aes(reorder(Name, NA_Sales), NA_Sales,fill = NA_Sales), stat = 'identity') + 
  scale_fill_viridis_c() +
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1,face="bold")) + labs(
    title = 'top 5 game sales in North America scale',
    x = 'Name') 
```

#### the top 5 game sales in Japan

```{r}
#the top 5 game sales in Japan scale
top5sales.JP <- games1 %>% 
  # order data with descending Japan
  arrange(desc(JP_Sales)) %>%
  # only select two column: Name, Japan
  select(Name,JP_Sales) %>% 
  slice_head(n=5) %>%
  print
```

```{r}
ggplot(data=top5sales.JP)+
  geom_bar(aes(reorder(Name, JP_Sales), JP_Sales,fill = JP_Sales), stat = 'identity') + 
  scale_fill_viridis_c() +
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1,face="bold")) + labs(
    title = 'top 5 game sales in North Japan scale',
    x = 'Name') 
```

#### the top 5 game sales in Europe

```{r}
#the top 5 game sales in EU scale
top5sales.EU <- games1 %>% 
  # order data with descending Japan
  arrange(desc(EU_Sales)) %>%
  # only select two column: Name, Japan
  select(Name,EU_Sales) %>% 
  slice_head(n=5) %>%
  print
```

```{r}
ggplot(data=top5sales.EU)+
  geom_bar(aes(reorder(Name, EU_Sales), EU_Sales,fill = EU_Sales), stat = 'identity') + 
  scale_fill_viridis_c() +
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1,face="bold")) + labs(
    title = 'top 5 game sales in North Europe scale',
    x = 'Name') 
```

### 2. the top 3 favoriate game genres in global, North Aemerica, Japan, Europe scale
#### we want to know is there any difference of game gerne preference among difference areas
##### for now we use the amount of sales to decide if a genre is welcomed

#### top 3 favoriate game genres in global scale
```{r}
top3genre.global <- games1 %>%
  group_by(Genre) %>%
  summarise(genre.sales = sum(Global_Sales)) %>%
  arrange(desc(genre.sales)) %>%
  slice_head(n=3) %>%
  print
```
#### top 3 favoriate game genres in North America scale
```{r}
top3genre.NA <- games1 %>%
  group_by(Genre) %>%
  summarise(genre.sales = sum(NA_Sales)) %>%
  arrange(desc(genre.sales)) %>%
  slice_head(n=3) %>%
  print
```

#### top 3 favoriate game genres in Japan scale
```{r}
top3genre.JP <- games1 %>%
  group_by(Genre) %>%
  summarise(genre.sales = sum(JP_Sales)) %>%
  arrange(desc(genre.sales)) %>%
  slice_head(n=3) %>%
  print
```


#### top 3 favoriate game genres in Europe scale
```{r}
top3genre.EU <- games1 %>%
  group_by(Genre) %>%
  summarise(genre.sales = sum(EU_Sales)) %>%
  arrange(desc(genre.sales)) %>%
  slice_head(n=3) %>%
  print
```



### 3. for each of the top 5 popular platform, the most welcomed game (highist sales)

#### the top 5 popular platform
```{r}
popular5platfrom <- games1 %>%
  group_by(Platform) %>%
  summarise(genre.sales = sum(Global_Sales)) %>%
  arrange(desc(genre.sales)) %>%
  slice_head(n=5) %>%
  print

popular5platfrom <- popular5platfrom$Platform
print(popular5platfrom)
```

# the most welcomed game on each top 5 populor platform
```{r}
welcomedGames.platform <- data.frame()

for (i in 1:5){
  game.plat <- games1 %>%
    filter(Platform == popular5platfrom[i]) %>%
    arrange(desc(Global_Sales)) %>%
    slice_head(n=1) %>%
    select(Platform,Name,Global_Sales)
  
  welcomedGames.platform <- rbind(welcomedGames.platform, game.plat)
}

print(welcomedGames.platform)
```

### 4. etc.
